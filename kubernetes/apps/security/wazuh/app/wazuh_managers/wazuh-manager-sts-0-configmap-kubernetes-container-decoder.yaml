---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kubernetes-container-decoder
  namespace: security
data:
  kubernetes_container.xml: |
    <!-- Kubernetes container log format decoder -->
    <!-- Handles format: "2025-12-31T15:44:32.855676826Z stdout F [actual message]" -->
    <!-- Extracts only the message portion, discarding timestamp, stream, and flags -->

    <decoder name="kubernetes-container">
      <prematch type="pcre2">^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z (stdout|stderr) [FP] </prematch>
      <regex type="pcre2">^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z (?:stdout|stderr) [FP] (.*)</regex>
      <order>log</order>
    </decoder>

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kubernetes-container-decoder
  namespace: security
data:
  00-kubernetes_container.xml: |
    <!-- Kubernetes container log format decoder -->
    <!-- Handles format: "2025-12-31T15:44:32.855676826Z stdout F [actual message]" -->
    <!-- Extracts only the message portion, discarding timestamp, stream, and flags -->

    <decoder name="kubernetes-container">
      <prematch>\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d\.</prematch>
      <regex>^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z (?:stdout|stderr) [FP] (.*)</regex>
      <order>log</order>
    </decoder>

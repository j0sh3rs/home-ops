<!-- Kubernetes container log format decoder -->
<!-- After Wazuh pre-decoding extracts timestamp, remaining format is: "stdout F [actual message]" -->
<!-- This decoder captures only the message portion, discarding stream type (stdout/stderr) and partial flag (F/P) -->
<decoder name="kubernetes-container">
  <prematch>^stdout |^stderr </prematch>
</decoder>

<decoder name="kubernetes-container-extract">
  <parent>kubernetes-container</parent>
  <regex>^[a-z]+ [FP] (.*)</regex>
  <order>log</order>
</decoder>
